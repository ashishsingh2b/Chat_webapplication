{"ast":null,"code":"var _jsxFileName = \"/home/ts/Downloads/django-chat-main/client/src/components/sidebar/sidebar.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport \"./sidebar.css\";\nimport { Link } from \"react-router-dom\";\nimport CookieUtil from \"../../util/cookieUtil\";\nimport AppPaths from \"../../lib/appPaths\";\nimport ApiConnector from \"../../api/apiConnector\";\nimport ApiEndpoints from \"../../api/apiEndpoints\";\nimport CommonUtil from \"../../util/commonUtil\";\nimport Constants from \"../../lib/constants\";\nimport Modal from \"../modal/modal\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Sidebar = props => {\n  _s();\n\n  const [chatUsers, setChatUsers] = useState([]); // sidebar users\n\n  const [users, setUsers] = useState([]); // popup users\n\n  const [isShowAddPeopleModal, setIsShowAddPeopleModal] = useState(false);\n\n  const redirectUserToDefaultChatRoom = chatUsers => {\n    var _props$location;\n\n    if (chatUsers.length === 0) return; // Avoid error if chatUsers is empty\n\n    if ((props === null || props === void 0 ? void 0 : (_props$location = props.location) === null || _props$location === void 0 ? void 0 : _props$location.pathname) === AppPaths.HOME) {\n      // Ensure chatUsers[0] is valid\n      if (chatUsers[0] && chatUsers[0].roomId) {\n        props.setCurrentChattingMember(chatUsers[0]);\n        props.history.push(\"/c/\" + chatUsers[0].roomId);\n      }\n    } else {\n      const activeChatId = CommonUtil.getActiveChatId(props.match);\n      const chatUser = chatUsers.find(user => user.roomId === activeChatId);\n\n      if (chatUser) {\n        props.setCurrentChattingMember(chatUser);\n      }\n    }\n  };\n\n  const fetchChatUser = async () => {\n    try {\n      const url = ApiEndpoints.USER_CHAT_URL.replace(Constants.USER_ID_PLACE_HOLDER, CommonUtil.getUserId());\n      const response = await ApiConnector.sendGetRequest(url);\n      const formatedChatUser = CommonUtil.getFormatedChatUser(response, props.onlineUserList);\n      setChatUsers(formatedChatUser);\n      redirectUserToDefaultChatRoom(formatedChatUser);\n    } catch (error) {\n      console.error(\"Error fetching chat users:\", error); // Optionally handle the error here (e.g., show an error message)\n    }\n  };\n\n  useEffect(() => {\n    fetchChatUser();\n  }, [props.onlineUserList]); // Include dependencies if needed\n\n  const getConnectedUserIds = () => {\n    return chatUsers.map(user => user.id).join(\",\");\n  };\n\n  const fetchUsers = async () => {\n    try {\n      const url = ApiEndpoints.USER_URL + \"?exclude=\" + getConnectedUserIds();\n      const response = await ApiConnector.sendGetRequest(url);\n      setUsers(response);\n    } catch (error) {\n      console.error(\"Error fetching users:\", error); // Optionally handle the error here (e.g., show an error message)\n    }\n  };\n\n  const addPeopleClickHandler = async () => {\n    await fetchUsers();\n    setIsShowAddPeopleModal(true);\n  };\n\n  const addMemberClickHandler = async memberId => {\n    try {\n      const userId = CommonUtil.getUserId();\n      let requestBody = {\n        members: [memberId, userId],\n        type: \"DM\"\n      };\n      await ApiConnector.sendPostRequest(ApiEndpoints.CHAT_URL, JSON.stringify(requestBody), true, false);\n      await fetchChatUser(); // Await fetchChatUser to ensure chatUsers is updated\n\n      setIsShowAddPeopleModal(false);\n    } catch (error) {\n      console.error(\"Error adding member:\", error); // Optionally handle the error here (e.g., show an error message)\n    }\n  };\n\n  const getActiveChatClass = roomId => {\n    const activeChatId = CommonUtil.getActiveChatId(props.match);\n    return roomId === activeChatId ? \"active-chat\" : \"\";\n  };\n\n  const logoutClickHandler = () => {\n    CookieUtil.deleteCookie(Constants.ACCESS_PROPERTY);\n    CookieUtil.deleteCookie(Constants.REFRESH_PROPERTY);\n    window.location.href = AppPaths.LOGIN;\n  };\n\n  const getChatListWithOnlineUser = () => {\n    return chatUsers.map(user => ({ ...user,\n      isOnline: props.onlineUserList.includes(user.id)\n    }));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"col-12 col-sm-4 col-md-4 col-lg-4 col-xl-2 border-right\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-none d-md-block\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: addPeopleClickHandler,\n        className: \"btn btn-outline-warning btn-block my-1 mt-4\",\n        children: \"Add People\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"user-list-container\",\n      children: getChatListWithOnlineUser().map(chatUser => /*#__PURE__*/_jsxDEV(Link, {\n        onClick: () => props.setCurrentChattingMember(chatUser),\n        to: `/c/${chatUser.roomId}`,\n        className: \"pl-1 list-group-item list-group-item-action border-0 \" + getActiveChatClass(chatUser.roomId),\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"d-flex align-items-start\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: chatUser.image,\n            className: \"rounded-circle mr-1\",\n            alt: chatUser.name,\n            width: \"40\",\n            height: \"40\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 139,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex-grow-1 ml-3\",\n            children: [chatUser.name, /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"small\",\n              children: chatUser.isOnline ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"fas fa-circle chat-online\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 151,\n                  columnNumber: 23\n                }, this), \" \", \"Online\"]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"fas fa-circle chat-offline\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 156,\n                  columnNumber: 23\n                }, this), \" \", \"Offline\"]\n              }, void 0, true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 148,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 13\n        }, this)\n      }, chatUser.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: logoutClickHandler,\n      className: \"btn btn-outline-danger btn-block mt-1\",\n      children: \"Log Out\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {\n      className: \"d-block d-lg-none mt-1 mb-0\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      modalCloseHandler: () => setIsShowAddPeopleModal(false),\n      show: isShowAddPeopleModal,\n      children: users.length > 0 ? users.map(user => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex align-items-start pt-1 pb-1 d-flex align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: user.image,\n          className: \"rounded-circle mr-1\",\n          alt: user.first_name + \" \" + user.last_name,\n          width: \"40\",\n          height: \"40\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-grow-1 ml-2 mr-5\",\n          children: user.first_name + \" \" + user.last_name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => addMemberClickHandler(user.id),\n          className: \"btn btn-sm btn-success\",\n          children: \"Add\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 15\n        }, this)]\n      }, user.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 13\n      }, this)) : /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"No More Users Found\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Sidebar, \"0t5Y0QmxrSdw0/f8gpi71bs06f0=\");\n\n_c = Sidebar;\nexport default Sidebar;\n\nvar _c;\n\n$RefreshReg$(_c, \"Sidebar\");","map":{"version":3,"sources":["/home/ts/Downloads/django-chat-main/client/src/components/sidebar/sidebar.js"],"names":["React","useEffect","useState","Link","CookieUtil","AppPaths","ApiConnector","ApiEndpoints","CommonUtil","Constants","Modal","Sidebar","props","chatUsers","setChatUsers","users","setUsers","isShowAddPeopleModal","setIsShowAddPeopleModal","redirectUserToDefaultChatRoom","length","location","pathname","HOME","roomId","setCurrentChattingMember","history","push","activeChatId","getActiveChatId","match","chatUser","find","user","fetchChatUser","url","USER_CHAT_URL","replace","USER_ID_PLACE_HOLDER","getUserId","response","sendGetRequest","formatedChatUser","getFormatedChatUser","onlineUserList","error","console","getConnectedUserIds","map","id","join","fetchUsers","USER_URL","addPeopleClickHandler","addMemberClickHandler","memberId","userId","requestBody","members","type","sendPostRequest","CHAT_URL","JSON","stringify","getActiveChatClass","logoutClickHandler","deleteCookie","ACCESS_PROPERTY","REFRESH_PROPERTY","window","href","LOGIN","getChatListWithOnlineUser","isOnline","includes","image","name","first_name","last_name"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,OAAO,eAAP;AACA,SAASC,IAAT,QAAqB,kBAArB;AACA,OAAOC,UAAP,MAAuB,uBAAvB;AACA,OAAOC,QAAP,MAAqB,oBAArB;AACA,OAAOC,YAAP,MAAyB,wBAAzB;AACA,OAAOC,YAAP,MAAyB,wBAAzB;AACA,OAAOC,UAAP,MAAuB,uBAAvB;AACA,OAAOC,SAAP,MAAsB,qBAAtB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;;;;AAEA,MAAMC,OAAO,GAAIC,KAAD,IAAW;AAAA;;AACzB,QAAM,CAACC,SAAD,EAAYC,YAAZ,IAA4BZ,QAAQ,CAAC,EAAD,CAA1C,CADyB,CACuB;;AAChD,QAAM,CAACa,KAAD,EAAQC,QAAR,IAAoBd,QAAQ,CAAC,EAAD,CAAlC,CAFyB,CAEe;;AACxC,QAAM,CAACe,oBAAD,EAAuBC,uBAAvB,IAAkDhB,QAAQ,CAAC,KAAD,CAAhE;;AAEA,QAAMiB,6BAA6B,GAAIN,SAAD,IAAe;AAAA;;AACnD,QAAIA,SAAS,CAACO,MAAV,KAAqB,CAAzB,EAA4B,OADuB,CACf;;AAEpC,QAAI,CAAAR,KAAK,SAAL,IAAAA,KAAK,WAAL,+BAAAA,KAAK,CAAES,QAAP,oEAAiBC,QAAjB,MAA8BjB,QAAQ,CAACkB,IAA3C,EAAiD;AAC/C;AACA,UAAIV,SAAS,CAAC,CAAD,CAAT,IAAgBA,SAAS,CAAC,CAAD,CAAT,CAAaW,MAAjC,EAAyC;AACvCZ,QAAAA,KAAK,CAACa,wBAAN,CAA+BZ,SAAS,CAAC,CAAD,CAAxC;AACAD,QAAAA,KAAK,CAACc,OAAN,CAAcC,IAAd,CAAmB,QAAQd,SAAS,CAAC,CAAD,CAAT,CAAaW,MAAxC;AACD;AACF,KAND,MAMO;AACL,YAAMI,YAAY,GAAGpB,UAAU,CAACqB,eAAX,CAA2BjB,KAAK,CAACkB,KAAjC,CAArB;AACA,YAAMC,QAAQ,GAAGlB,SAAS,CAACmB,IAAV,CAAgBC,IAAD,IAAUA,IAAI,CAACT,MAAL,KAAgBI,YAAzC,CAAjB;;AACA,UAAIG,QAAJ,EAAc;AACZnB,QAAAA,KAAK,CAACa,wBAAN,CAA+BM,QAA/B;AACD;AACF;AACF,GAhBD;;AAkBA,QAAMG,aAAa,GAAG,YAAY;AAChC,QAAI;AACF,YAAMC,GAAG,GAAG5B,YAAY,CAAC6B,aAAb,CAA2BC,OAA3B,CACV5B,SAAS,CAAC6B,oBADA,EAEV9B,UAAU,CAAC+B,SAAX,EAFU,CAAZ;AAIA,YAAMC,QAAQ,GAAG,MAAMlC,YAAY,CAACmC,cAAb,CAA4BN,GAA5B,CAAvB;AACA,YAAMO,gBAAgB,GAAGlC,UAAU,CAACmC,mBAAX,CACvBH,QADuB,EAEvB5B,KAAK,CAACgC,cAFiB,CAAzB;AAIA9B,MAAAA,YAAY,CAAC4B,gBAAD,CAAZ;AACAvB,MAAAA,6BAA6B,CAACuB,gBAAD,CAA7B;AACD,KAZD,CAYE,OAAOG,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAc,4BAAd,EAA4CA,KAA5C,EADc,CAEd;AACD;AACF,GAjBD;;AAmBA5C,EAAAA,SAAS,CAAC,MAAM;AACdiC,IAAAA,aAAa;AACd,GAFQ,EAEN,CAACtB,KAAK,CAACgC,cAAP,CAFM,CAAT,CA1CyB,CA4CG;;AAE5B,QAAMG,mBAAmB,GAAG,MAAM;AAChC,WAAOlC,SAAS,CAACmC,GAAV,CAAef,IAAD,IAAUA,IAAI,CAACgB,EAA7B,EAAiCC,IAAjC,CAAsC,GAAtC,CAAP;AACD,GAFD;;AAIA,QAAMC,UAAU,GAAG,YAAY;AAC7B,QAAI;AACF,YAAMhB,GAAG,GAAG5B,YAAY,CAAC6C,QAAb,GAAwB,WAAxB,GAAsCL,mBAAmB,EAArE;AACA,YAAMP,QAAQ,GAAG,MAAMlC,YAAY,CAACmC,cAAb,CAA4BN,GAA5B,CAAvB;AACAnB,MAAAA,QAAQ,CAACwB,QAAD,CAAR;AACD,KAJD,CAIE,OAAOK,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAc,uBAAd,EAAuCA,KAAvC,EADc,CAEd;AACD;AACF,GATD;;AAWA,QAAMQ,qBAAqB,GAAG,YAAY;AACxC,UAAMF,UAAU,EAAhB;AACAjC,IAAAA,uBAAuB,CAAC,IAAD,CAAvB;AACD,GAHD;;AAKA,QAAMoC,qBAAqB,GAAG,MAAOC,QAAP,IAAoB;AAChD,QAAI;AACF,YAAMC,MAAM,GAAGhD,UAAU,CAAC+B,SAAX,EAAf;AACA,UAAIkB,WAAW,GAAG;AAChBC,QAAAA,OAAO,EAAE,CAACH,QAAD,EAAWC,MAAX,CADO;AAEhBG,QAAAA,IAAI,EAAE;AAFU,OAAlB;AAIA,YAAMrD,YAAY,CAACsD,eAAb,CACJrD,YAAY,CAACsD,QADT,EAEJC,IAAI,CAACC,SAAL,CAAeN,WAAf,CAFI,EAGJ,IAHI,EAIJ,KAJI,CAAN;AAMA,YAAMvB,aAAa,EAAnB,CAZE,CAYqB;;AACvBhB,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD,KAdD,CAcE,OAAO2B,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAc,sBAAd,EAAsCA,KAAtC,EADc,CAEd;AACD;AACF,GAnBD;;AAqBA,QAAMmB,kBAAkB,GAAIxC,MAAD,IAAY;AACrC,UAAMI,YAAY,GAAGpB,UAAU,CAACqB,eAAX,CAA2BjB,KAAK,CAACkB,KAAjC,CAArB;AACA,WAAON,MAAM,KAAKI,YAAX,GAA0B,aAA1B,GAA0C,EAAjD;AACD,GAHD;;AAKA,QAAMqC,kBAAkB,GAAG,MAAM;AAC/B7D,IAAAA,UAAU,CAAC8D,YAAX,CAAwBzD,SAAS,CAAC0D,eAAlC;AACA/D,IAAAA,UAAU,CAAC8D,YAAX,CAAwBzD,SAAS,CAAC2D,gBAAlC;AACAC,IAAAA,MAAM,CAAChD,QAAP,CAAgBiD,IAAhB,GAAuBjE,QAAQ,CAACkE,KAAhC;AACD,GAJD;;AAMA,QAAMC,yBAAyB,GAAG,MAAM;AACtC,WAAO3D,SAAS,CAACmC,GAAV,CAAef,IAAD,KAAW,EAC9B,GAAGA,IAD2B;AAE9BwC,MAAAA,QAAQ,EAAE7D,KAAK,CAACgC,cAAN,CAAqB8B,QAArB,CAA8BzC,IAAI,CAACgB,EAAnC;AAFoB,KAAX,CAAd,CAAP;AAID,GALD;;AAOA,sBACE;AAAK,IAAA,SAAS,EAAC,yDAAf;AAAA,4BACE;AAAK,MAAA,SAAS,EAAC,mBAAf;AAAA,6BACE;AACE,QAAA,OAAO,EAAEI,qBADX;AAEE,QAAA,SAAS,EAAC,6CAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,YADF,eASE;AAAK,MAAA,SAAS,EAAC,qBAAf;AAAA,gBACGmB,yBAAyB,GAAGxB,GAA5B,CAAiCjB,QAAD,iBAC/B,QAAC,IAAD;AACE,QAAA,OAAO,EAAE,MAAMnB,KAAK,CAACa,wBAAN,CAA+BM,QAA/B,CADjB;AAEE,QAAA,EAAE,EAAG,MAAKA,QAAQ,CAACP,MAAO,EAF5B;AAGE,QAAA,SAAS,EACP,0DACAwC,kBAAkB,CAACjC,QAAQ,CAACP,MAAV,CALtB;AAAA,+BASE;AAAK,UAAA,SAAS,EAAC,0BAAf;AAAA,kCACE;AACE,YAAA,GAAG,EAAEO,QAAQ,CAAC4C,KADhB;AAEE,YAAA,SAAS,EAAC,qBAFZ;AAGE,YAAA,GAAG,EAAE5C,QAAQ,CAAC6C,IAHhB;AAIE,YAAA,KAAK,EAAC,IAJR;AAKE,YAAA,MAAM,EAAC;AALT;AAAA;AAAA;AAAA;AAAA,kBADF,eAQE;AAAK,YAAA,SAAS,EAAC,kBAAf;AAAA,uBACG7C,QAAQ,CAAC6C,IADZ,eAEE;AAAK,cAAA,SAAS,EAAC,OAAf;AAAA,wBACG7C,QAAQ,CAAC0C,QAAT,gBACC;AAAA,wCACE;AAAM,kBAAA,SAAS,EAAC;AAAhB;AAAA;AAAA;AAAA;AAAA,wBADF,EACsD,GADtD;AAAA,8BADD,gBAMC;AAAA,wCACE;AAAM,kBAAA,SAAS,EAAC;AAAhB;AAAA;AAAA;AAAA;AAAA,wBADF,EACuD,GADvD;AAAA;AAPJ;AAAA;AAAA;AAAA;AAAA,oBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,kBARF;AAAA;AAAA;AAAA;AAAA;AAAA;AATF,SAOO1C,QAAQ,CAACkB,EAPhB;AAAA;AAAA;AAAA;AAAA,cADD;AADH;AAAA;AAAA;AAAA;AAAA,YATF,eAgDE;AACE,MAAA,OAAO,EAAEgB,kBADX;AAEE,MAAA,SAAS,EAAC,uCAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAhDF,eAsDE;AAAI,MAAA,SAAS,EAAC;AAAd;AAAA;AAAA;AAAA;AAAA,YAtDF,eAuDE,QAAC,KAAD;AACE,MAAA,iBAAiB,EAAE,MAAM/C,uBAAuB,CAAC,KAAD,CADlD;AAEE,MAAA,IAAI,EAAED,oBAFR;AAAA,gBAIGF,KAAK,CAACK,MAAN,GAAe,CAAf,GACCL,KAAK,CAACiC,GAAN,CAAWf,IAAD,iBACR;AAEE,QAAA,SAAS,EAAC,8DAFZ;AAAA,gCAIE;AACE,UAAA,GAAG,EAAEA,IAAI,CAAC0C,KADZ;AAEE,UAAA,SAAS,EAAC,qBAFZ;AAGE,UAAA,GAAG,EAAE1C,IAAI,CAAC4C,UAAL,GAAkB,GAAlB,GAAwB5C,IAAI,CAAC6C,SAHpC;AAIE,UAAA,KAAK,EAAC,IAJR;AAKE,UAAA,MAAM,EAAC;AALT;AAAA;AAAA;AAAA;AAAA,gBAJF,eAWE;AAAK,UAAA,SAAS,EAAC,uBAAf;AAAA,oBACG7C,IAAI,CAAC4C,UAAL,GAAkB,GAAlB,GAAwB5C,IAAI,CAAC6C;AADhC;AAAA;AAAA;AAAA;AAAA,gBAXF,eAcE;AACE,UAAA,OAAO,EAAE,MAAMxB,qBAAqB,CAACrB,IAAI,CAACgB,EAAN,CADtC;AAEE,UAAA,SAAS,EAAC,wBAFZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAdF;AAAA,SACOhB,IAAI,CAACgB,EADZ;AAAA;AAAA;AAAA;AAAA,cADF,CADD,gBAyBC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA7BJ;AAAA;AAAA;AAAA;AAAA,YAvDF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AA0FD,CAnMD;;GAAMtC,O;;KAAAA,O;AAqMN,eAAeA,OAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport \"./sidebar.css\";\nimport { Link } from \"react-router-dom\";\nimport CookieUtil from \"../../util/cookieUtil\";\nimport AppPaths from \"../../lib/appPaths\";\nimport ApiConnector from \"../../api/apiConnector\";\nimport ApiEndpoints from \"../../api/apiEndpoints\";\nimport CommonUtil from \"../../util/commonUtil\";\nimport Constants from \"../../lib/constants\";\nimport Modal from \"../modal/modal\";\n\nconst Sidebar = (props) => {\n  const [chatUsers, setChatUsers] = useState([]); // sidebar users\n  const [users, setUsers] = useState([]); // popup users\n  const [isShowAddPeopleModal, setIsShowAddPeopleModal] = useState(false);\n\n  const redirectUserToDefaultChatRoom = (chatUsers) => {\n    if (chatUsers.length === 0) return; // Avoid error if chatUsers is empty\n\n    if (props?.location?.pathname === AppPaths.HOME) {\n      // Ensure chatUsers[0] is valid\n      if (chatUsers[0] && chatUsers[0].roomId) {\n        props.setCurrentChattingMember(chatUsers[0]);\n        props.history.push(\"/c/\" + chatUsers[0].roomId);\n      }\n    } else {\n      const activeChatId = CommonUtil.getActiveChatId(props.match);\n      const chatUser = chatUsers.find((user) => user.roomId === activeChatId);\n      if (chatUser) {\n        props.setCurrentChattingMember(chatUser);\n      }\n    }\n  };\n\n  const fetchChatUser = async () => {\n    try {\n      const url = ApiEndpoints.USER_CHAT_URL.replace(\n        Constants.USER_ID_PLACE_HOLDER,\n        CommonUtil.getUserId()\n      );\n      const response = await ApiConnector.sendGetRequest(url);\n      const formatedChatUser = CommonUtil.getFormatedChatUser(\n        response,\n        props.onlineUserList\n      );\n      setChatUsers(formatedChatUser);\n      redirectUserToDefaultChatRoom(formatedChatUser);\n    } catch (error) {\n      console.error(\"Error fetching chat users:\", error);\n      // Optionally handle the error here (e.g., show an error message)\n    }\n  };\n\n  useEffect(() => {\n    fetchChatUser();\n  }, [props.onlineUserList]); // Include dependencies if needed\n\n  const getConnectedUserIds = () => {\n    return chatUsers.map((user) => user.id).join(\",\");\n  };\n\n  const fetchUsers = async () => {\n    try {\n      const url = ApiEndpoints.USER_URL + \"?exclude=\" + getConnectedUserIds();\n      const response = await ApiConnector.sendGetRequest(url);\n      setUsers(response);\n    } catch (error) {\n      console.error(\"Error fetching users:\", error);\n      // Optionally handle the error here (e.g., show an error message)\n    }\n  };\n\n  const addPeopleClickHandler = async () => {\n    await fetchUsers();\n    setIsShowAddPeopleModal(true);\n  };\n\n  const addMemberClickHandler = async (memberId) => {\n    try {\n      const userId = CommonUtil.getUserId();\n      let requestBody = {\n        members: [memberId, userId],\n        type: \"DM\",\n      };\n      await ApiConnector.sendPostRequest(\n        ApiEndpoints.CHAT_URL,\n        JSON.stringify(requestBody),\n        true,\n        false\n      );\n      await fetchChatUser(); // Await fetchChatUser to ensure chatUsers is updated\n      setIsShowAddPeopleModal(false);\n    } catch (error) {\n      console.error(\"Error adding member:\", error);\n      // Optionally handle the error here (e.g., show an error message)\n    }\n  };\n\n  const getActiveChatClass = (roomId) => {\n    const activeChatId = CommonUtil.getActiveChatId(props.match);\n    return roomId === activeChatId ? \"active-chat\" : \"\";\n  };\n\n  const logoutClickHandler = () => {\n    CookieUtil.deleteCookie(Constants.ACCESS_PROPERTY);\n    CookieUtil.deleteCookie(Constants.REFRESH_PROPERTY);\n    window.location.href = AppPaths.LOGIN;\n  };\n\n  const getChatListWithOnlineUser = () => {\n    return chatUsers.map((user) => ({\n      ...user,\n      isOnline: props.onlineUserList.includes(user.id),\n    }));\n  };\n\n  return (\n    <div className=\"col-12 col-sm-4 col-md-4 col-lg-4 col-xl-2 border-right\">\n      <div className=\"d-none d-md-block\">\n        <button\n          onClick={addPeopleClickHandler}\n          className=\"btn btn-outline-warning btn-block my-1 mt-4\"\n        >\n          Add People\n        </button>\n      </div>\n      <div className=\"user-list-container\">\n        {getChatListWithOnlineUser().map((chatUser) => (\n          <Link\n            onClick={() => props.setCurrentChattingMember(chatUser)}\n            to={`/c/${chatUser.roomId}`}\n            className={\n              \"pl-1 list-group-item list-group-item-action border-0 \" +\n              getActiveChatClass(chatUser.roomId)\n            }\n            key={chatUser.id}\n          >\n            <div className=\"d-flex align-items-start\">\n              <img\n                src={chatUser.image}\n                className=\"rounded-circle mr-1\"\n                alt={chatUser.name}\n                width=\"40\"\n                height=\"40\"\n              />\n              <div className=\"flex-grow-1 ml-3\">\n                {chatUser.name}\n                <div className=\"small\">\n                  {chatUser.isOnline ? (\n                    <>\n                      <span className=\"fas fa-circle chat-online\"></span>{\" \"}\n                      Online\n                    </>\n                  ) : (\n                    <>\n                      <span className=\"fas fa-circle chat-offline\"></span>{\" \"}\n                      Offline\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n          </Link>\n        ))}\n      </div>\n      <button\n        onClick={logoutClickHandler}\n        className=\"btn btn-outline-danger btn-block mt-1\"\n      >\n        Log Out\n      </button>\n      <hr className=\"d-block d-lg-none mt-1 mb-0\" />\n      <Modal\n        modalCloseHandler={() => setIsShowAddPeopleModal(false)}\n        show={isShowAddPeopleModal}\n      >\n        {users.length > 0 ? (\n          users.map((user) => (\n            <div\n              key={user.id}\n              className=\"d-flex align-items-start pt-1 pb-1 d-flex align-items-center\"\n            >\n              <img\n                src={user.image}\n                className=\"rounded-circle mr-1\"\n                alt={user.first_name + \" \" + user.last_name}\n                width=\"40\"\n                height=\"40\"\n              />\n              <div className=\"flex-grow-1 ml-2 mr-5\">\n                {user.first_name + \" \" + user.last_name}\n              </div>\n              <button\n                onClick={() => addMemberClickHandler(user.id)}\n                className=\"btn btn-sm btn-success\"\n              >\n                Add\n              </button>\n            </div>\n          ))\n        ) : (\n          <h3>No More Users Found</h3>\n        )}\n      </Modal>\n    </div>\n  );\n};\n\nexport default Sidebar;\n  "]},"metadata":{},"sourceType":"module"}